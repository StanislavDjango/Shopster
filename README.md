# Shopster â€” Full-Stack Commerce Demo

[![Backend CI](https://github.com/StanislavDjango/Shopster/actions/workflows/backend-ci.yml/badge.svg)](https://github.com/StanislavDjango/Shopster/actions/workflows/backend-ci.yml)
[![Frontend CI](https://github.com/StanislavDjango/Shopster/actions/workflows/frontend-ci.yml/badge.svg)](https://github.com/StanislavDjango/Shopster/actions/workflows/frontend-ci.yml)
[![Docker Hub](https://img.shields.io/badge/docker-ready-blue?logo=docker)](https://hub.docker.com/u/stanyslav)

Shopster is a production-ready ecommerce starter that combines a **Django 5 / DRF** backend with a **Next.js 15 / TypeScript** storefront. The goal of this repository is to demonstrate a real-world, end-to-end web product: API design, infrastructure, UX, and deployment.

---

## ğŸš€ Live Demo & References

| Surface | URL | Notes |
| --- | --- | --- |
| Storefront | http://159.89.27.194:3000 | Next.js SSR storefront with catalog, checkout, account area |
| Backend API | http://159.89.27.194:8000 | Django/Gunicorn service (REST API + admin) |
| Swagger UI | http://159.89.27.194:8000/api/docs/ | Interactive API reference |
| OpenAPI JSON | http://159.89.27.194:8000/api/schema/ | Machine-readable schema |
| Admin (Jazzmin) | http://159.89.27.194:8000/admin/ | Customised Django admin (request demo creds) |

---

## ğŸ§© Tech Stack

| Layer | Technologies |
| --- | --- |
| Backend | Django 5, Django REST Framework, PostgreSQL 16, Redis 7, SimpleJWT, django-filter, django-taggit, django-quill, Sentry |
| Frontend | Next.js 15 (App Router), React 18, TypeScript, NextAuth, Zustand, Algolia InstantSearch, SEO helpers |
| Infrastructure & Tooling | Docker Compose, Gunicorn, Whitenoise, go-task, pre-commit (ruff, black, isort, prettier), GitHub Actions (CI), Algolia sync scripts |

---

## âœ… Feature Highlights

### Backend
- Catalog & orders: products, categories, images, carts, orders with soft delete and audit actions.
- Authentication: JWT login/refresh, profile updates, password reset flows.
- Content & SEO: blog module (Quill rich text, tags), SEO meta fields, sitemap/robots, OpenGraph defaults.
- Search: Algolia indexing and sync via management commands.
- Tooling: Swagger/Redoc, OpenAPI schema, django-debug-toolbar, django-extensions.

### Frontend
- Product discovery: filters (category, price range, stock status, ordering), server-side search, infinite scroll.
- Algolia autosuggest: type-ahead dropdown with quick navigation links.
- Cart & checkout: Zustand state management, checkout success flow with order summary.
- Account experience: sign up/in, forgot password, profile forms, protected routes.
- Blog: listing and detail pages with metadata and tags synced from Django admin.
- SEO: metadata utilities, canonical URLs, sitemap integration.

### DevOps & DX
- Dockerised dev/prod parity (web, frontend, db, redis services).
- go-task macros for lint/format/test, pre-commit hooks for Python & JS.
- GitHub Actions workflows for backend and frontend lint/build checks.
- Deployment notes, DB dump/import scripts, Algolia sync helpers.

## CI/CD Pipeline

| Workflow | Trigger | Purpose |
| --- | --- | --- |
| Backend CI (`backend-ci.yml`) | Push/PR touching backend files | Ruff/Black/isort, Django system checks, smoke pytest |
| Frontend CI (`frontend-ci.yml`) | Push/PR touching frontend files | `npm ci`, `npm run lint`, `npm run build` |
| Docker build & push (`docker-build.yml`) | Push to `main`, tags `v*`, manual dispatch | Builds/pushes Docker images and runs backend smoke test |
| Release (`release.yml`) | Tag `v*` | Publishes GitHub Release with autogenerated notes and artifacts |
| Lighthouse audit (`lighthouse.yml`) | Weekly cron/manual | Non-blocking Lighthouse run against production storefront |
| Dependabot auto-merge | Dependabot PRs | Enables auto-merge for patch dependency bumps after green CI |
| Security scan (`security-scan.yml`) | Push/PR touching dependency locks + nightly cron | Runs `pip-audit` and `npm audit --production` |

**Secrets required**

| Secret | Used by | Notes |
| --- | --- | --- |
| `DOCKERHUB_USERNAME` / `DOCKERHUB_TOKEN` | Docker workflow | Credentials with push rights to Docker Hub |
| `ALGOLIA_*`, `SENTRY_*`, etc. | Deployment envs | Stored in `.env`/server secrets (not in CI) |

**Release flow**

1. Merge changes to `main`.
2. Tag the commit: `git tag vX.Y.Z && git push origin vX.Y.Z`.
3. The Docker workflow builds/pushes images, `release.yml` publishes notes, and auto-merge/Lighthouse jobs continue on schedule.

You can also re-run `Build and Push Docker Images` manually from the Actions tab when you need to republish images with new secrets.

### Branch protection checklist

1. GitHub â†’ Repo â†’ `Settings` â†’ `Branches` â†’ `Branch protection rules`.
2. Add a rule for `main` with:
   - Require a pull-request before merging (dismiss stale reviews).
   - Require status checks: `Backend CI`, `Frontend CI`, `Build and Push Docker Images`, `Dependabot Auto Merge`.
   - Require linear history / disallow force pushes (optional but recommended).
3. Save the rule. After ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ½Ğ¸ Ğ¾Ğ´Ğ¸Ğ½ ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚ Ğ½Ğµ Ğ¿Ğ¾Ğ¿Ğ°Ğ´Ñ‘Ñ‚ Ğ² `main` Ğ±ĞµĞ· Ğ·ĞµĞ»ĞµĞ½Ğ¾Ğ³Ğ¾ CI Ğ¸ Ñ€ĞµĞ²ÑŒÑ.

---

## ğŸ—º Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Docker                               â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    REST/JSON     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Redis Cache  â”‚
â”‚  â”‚  frontend   â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚    web      â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Next.js 15  â”‚                  â”‚ Django/DRF  â”‚               â”‚  â”‚
â”‚  â”‚ Port 3000   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Port 8000   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    static + API  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â–²                              â”‚                          â”‚
â”‚         â”‚ SSR/ISR                      â”‚ ORM                      â”‚
â”‚         â”‚                              â–¼                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Browser   â”‚                 â”‚ PostgreSQL  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  search sync  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Management  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   Algolia   â”‚                    â”‚
â”‚  â”‚ Commands    â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›  Getting Started (Local)

### Prerequisites
- Docker & Docker Compose
- Node.js 20+ (for local storefront development)
- go-task (`winget install Task.Task`) â€” optional yet convenient

### 1. Clone the repo & prepare environment variables

```bash
git clone https://github.com/StanislavDjango/Shopster.git
cd Shopster
cp .env.example .env
cp frontend/.env.local.example frontend/.env.local
```

Fill in the key parameters (JWT secret, Algolia credentials, database).

> **Tip for Windows/WSL users:** the default `frontend/.env.local` now points to `http://host.docker.internal:8000`.  
> If you open the dev server from another IP (e.g. `http://172.28.x.x:3000`), add that origin to
> `NEXT_DEV_ALLOWED_ORIGINS` in `.env.local` so Next.js allows cross-origin dev connections:
> `NEXT_DEV_ALLOWED_ORIGINS=http://172.28.224.1:3000`.

### 2. Run via Docker

```bash
docker compose up --build -d
docker compose exec web python backend/manage.py migrate
docker compose exec web python backend/manage.py createsuperuser
docker compose exec web python backend/manage.py load_demo_data --reset --products 120
```

### 3. Frontend in dev mode

```bash
cd frontend
npm install
npm run dev
```

### Useful URLs
- Storefront: `http://localhost:3000`
- API root: `http://localhost:8000/api/`
- Swagger: `http://localhost:8000/api/docs/`
- Admin: `http://localhost:8000/admin/`

---

## ğŸ§ª Linting & Tests

```bash
# unified command (requires go-task)
task lint
# auto-formatting
task format:fix

# manual commands
ruff check backend
black backend
isort backend
(cd frontend && npm run lint)
(cd frontend && npm run test)     # if unit/e2e tests are added
```

---

## ğŸš€ Deployment Notes

- Production runs on a VPS using Docker Compose (`deploy/docker-compose.yml`).
- Container images are available on Docker Hub:
  - `stanyslav/vebsaythub:latest` â€” backend (Gunicorn + Django)
  - `stanyslav/vebsayt-frontend:latest` â€” Next.js storefront
- Environment files live on the server in `/srv/vebsayt` (`.env`, `.env.local.frontend`).
- Algolia re-sync:
  ```bash
  docker compose exec web python backend/manage.py sync_algolia_products --clear
  ```
- Detailed deployment steps are documented in [`docs/deployment-notes.md`](docs/deployment-notes.md).

---

## ğŸ“‚ Project Structure

```
Shopster/
â”œâ”€â”€ backend/                # Django project (core, shop, accounts, content apps)
â”œâ”€â”€ frontend/               # Next.js storefront
â”œâ”€â”€ deploy/                 # Production compose + env templates
â”œâ”€â”€ docker/                 # Entry points, Dockerfiles
â”œâ”€â”€ docs/                   # Deployment and architecture notes
â”œâ”€â”€ scripts/                # Utility scripts (dump/import)
â”œâ”€â”€ Taskfile.yml            # go-task recipes
â”œâ”€â”€ docker-compose.yml      # Dev compose
â”œâ”€â”€ docker-compose.prod.yml # Production compose example
â””â”€â”€ README.md
```

---

## ğŸ§­ Roadmap Ideas
- Integrate Stripe/YooKassa payments with webhook handling.
- Add Celery/RQ workers for email, indexing, background jobs.
- Extend GitHub Actions with pytest, coverage reports, Docker build & push.
- Publish JSON-LD schema.org for products and blog posts.
- Infrastructure-as-code examples with Terraform/Ansible.

---

## ğŸ—ƒ Additional Docs

- [Architecture overview](docs/architecture.md)
- [API request examples](docs/api-examples.md)
- [Postman collection](docs/postman/Shopster.postman_collection.json)
- [Triage & project workflow](docs/triage-guide.md)
- [Deployment runbook](docs/deployment-notes.md)

---

## ğŸ¤ Contributing

1. Fork the repository and create a feature branch: `git checkout -b feature/my-improvement`.
2. Install tooling (`pip install -r requirements-dev.txt`, `npm install` in `frontend/`) and enable hooks: `pre-commit install`.
3. Run the quality gates (hooks use the same commands under the hood):
   ```bash
   task lint
   task format:fix
   pre-commit run --all-files   # optional full sweep before the first push
   task hooks:safe              # run hooks inside a temporary worktree (patch saved to tmp/ if fixes are needed)
   ```
4. Commit with conventional messages and open a Pull Request. The CI pipelines (backend/frontend) must pass before merge.

Bug reports and feature ideas are welcome via [Issues](https://github.com/StanislavDjango/Shopster/issues).

---

## ğŸ“„ License

Released under the [MIT License](LICENSE). Youâ€™re free to use the code in commercial or personal projects with proper attribution.

---

## ğŸ‘‹ Contact

- **Author:** Stanislav Stankevych ([@StanislavDjango](https://github.com/StanislavDjango))
- **Demo:** http://159.89.27.194:3000
- **Feedback:** please open an issue or use the contact details in the GitHub profile.

> Contributions, ideas, and reviews are always welcome!

---

## ğŸ–¼ Screenshots

| Home | Catalog |
| --- | --- |
| ![Home](https://image.thum.io/get/width/800/crop/800/http://159.89.27.194:3000/) | ![Catalog](https://image.thum.io/get/width/800/crop/800/http://159.89.27.194:3000/products) |
